set2_manual_palette = c(
"Centre" = "#66C2A5",
"Centre-Left" = "#FC8D62",
"Centre-Right" = "#8DA0CB",
"Far-Left" = "#E78AC3",
"Far-Right" = "#A6D854",
"Left" = "#FFD92F",
"Right" = "#E5C494",
"Syncretic" = "#B3B3B3"
)
coll_cricle <- function(sel_house, sel_year) {
list_coll_filled %>%
filter((House == sel_house) & (Percent > 0) & (Year == sel_year)) %>%
mutate(Rank = rank(Percent)) %>%
ggplot(aes(x=Rank, y=Percent*100, fill=Collocation, alpha=0.7)) +
geom_bar(stat="identity") +
geom_text(
hjust = 1,
size = 7,
aes( y = 0, label = paste(
Collocation, " ")
)
) +
theme_minimal() +
scale_fill_manual(values =  set2_manual_palette) +
theme(
panel.grid = element_blank(),
panel.border = element_blank(),
legend.position="none",
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
plot.margin=grid::unit(c(0,0,0,0), "cm")
) +
coord_polar(theta = "y") +
ylim(0,10000)
}
employment_rate_line <- ggplot(empl_rate_it, aes(x=Year, y=Empl.Rate)) +
geom_line()  +
geom_point(
data=empl_rate_it[empl_rate_it$Year==1995 | empl_rate_it$Year==2013,],
aes(color="Red", group=interaction(Year))
) +
geom_text(
data=empl_rate_it[empl_rate_it$Year==1995 | empl_rate_it$Year==2013,],
aes(color="Red", label="Local min.", group=interaction(Year)),
hjust=-0.1, vjust=1.1, size=7
) +
scale_fill_brewer(palette="Set2") +
scale_x_discrete(limits=election_years[election_years>1976]) +
expand_limits(x=2025) +
scale_y_continuous(labels=function(x) paste0(x, "%"), breaks=seq(53, 59, 1)) +
ylab("Employment rate") +
xlab("(Election) Year") +
geom_vline(xintercept=1994, color="Grey", linetype=2, alpha=0.5) +
geom_vline(xintercept=2013, color="Grey", linetype=2, alpha=0.5) +
ggtitle("Employment rate / Political collocation (Senate)") +
theme_bw() +
theme(
axis.text.x = element_text(angle = 60, hjust = 1),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border =
)
employment_rate_line +
annotation_custom(grob = ggplotGrob(coll_cricle("Senate", 1992)), xmin = 1949, ymin = 55, ymax = 59) +
annotation_custom(grob = ggplotGrob(coll_cricle("Senate", 2008)), xmin = 1987, ymin = 52.5, ymax = 56.5) +
annotation_custom(grob = ggplotGrob(coll_cricle("Senate", 2018)), xmin = 2012, ymin = 51.5, ymax = 55.5)
dev.off()
knitr::include_graphics("./images/employment_coll.png")
png("./images/employment_coll.png",height=750,width=1400)
set2_manual_palette = c(
"Centre" = "#66C2A5",
"Centre-Left" = "#FC8D62",
"Centre-Right" = "#8DA0CB",
"Far-Left" = "#E78AC3",
"Far-Right" = "#A6D854",
"Left" = "#FFD92F",
"Right" = "#E5C494",
"Syncretic" = "#B3B3B3"
)
coll_cricle <- function(sel_house, sel_year) {
list_coll_filled %>%
filter((House == sel_house) & (Percent > 0) & (Year == sel_year)) %>%
mutate(Rank = rank(Percent)) %>%
ggplot(aes(x=Rank, y=Percent*100, fill=Collocation, alpha=0.7)) +
geom_bar(stat="identity") +
geom_text(
hjust = 1,
size = 7,
aes( y = 0, label = paste(
Collocation, " ")
)
) +
theme_minimal() +
scale_fill_manual(values =  set2_manual_palette) +
theme(
panel.grid = element_blank(),
panel.border = element_blank(),
legend.position="none",
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
plot.margin=grid::unit(c(0,0,0,0), "cm")
) +
coord_polar(theta = "y") +
ylim(0,10000)
}
employment_rate_line <- ggplot(empl_rate_it, aes(x=Year, y=Empl.Rate)) +
geom_line()  +
geom_point(
data=empl_rate_it[empl_rate_it$Year==1995 | empl_rate_it$Year==2013,],
aes(color="Red", group=interaction(Year))
) +
geom_text(
data=empl_rate_it[empl_rate_it$Year==1995 | empl_rate_it$Year==2013,],
aes(color="Red", label="Local min.", group=interaction(Year)),
hjust=-0.1, vjust=1.1, size=7
) +
scale_fill_brewer(palette="Set2") +
scale_x_discrete(limits=election_years[election_years>1976]) +
expand_limits(x=2025) +
scale_y_continuous(labels=function(x) paste0(x, "%"), breaks=seq(53, 59, 1)) +
ylab("Employment rate") +
xlab("(Election) Year") +
geom_vline(xintercept=1994, color="Grey", linetype=2, alpha=0.5) +
geom_vline(xintercept=2013, color="Grey", linetype=2, alpha=0.5) +
ggtitle("Employment rate / Political collocation (Senate)") +
theme_bw() +
theme(
axis.text.x = element_text(angle = 60, hjust = 1, size=7),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border =
)
employment_rate_line +
annotation_custom(grob = ggplotGrob(coll_cricle("Senate", 1992)), xmin = 1949, ymin = 55, ymax = 59) +
annotation_custom(grob = ggplotGrob(coll_cricle("Senate", 2008)), xmin = 1987, ymin = 52.5, ymax = 56.5) +
annotation_custom(grob = ggplotGrob(coll_cricle("Senate", 2018)), xmin = 2012, ymin = 51.5, ymax = 55.5)
dev.off()
knitr::include_graphics("./images/employment_coll.png")
png("./images/employment_coll.png",height=750,width=1400)
set2_manual_palette = c(
"Centre" = "#66C2A5",
"Centre-Left" = "#FC8D62",
"Centre-Right" = "#8DA0CB",
"Far-Left" = "#E78AC3",
"Far-Right" = "#A6D854",
"Left" = "#FFD92F",
"Right" = "#E5C494",
"Syncretic" = "#B3B3B3"
)
coll_cricle <- function(sel_house, sel_year) {
list_coll_filled %>%
filter((House == sel_house) & (Percent > 0) & (Year == sel_year)) %>%
mutate(Rank = rank(Percent)) %>%
ggplot(aes(x=Rank, y=Percent*100, fill=Collocation, alpha=0.7)) +
geom_bar(stat="identity") +
geom_text(
hjust = 1,
size = 7,
aes( y = 0, label = paste(
Collocation, " ")
)
) +
theme_minimal() +
scale_fill_manual(values =  set2_manual_palette) +
theme(
panel.grid = element_blank(),
panel.border = element_blank(),
legend.position="none",
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
plot.margin=grid::unit(c(0,0,0,0), "cm")
) +
coord_polar(theta = "y") +
ylim(0,10000)
}
employment_rate_line <- ggplot(empl_rate_it, aes(x=Year, y=Empl.Rate)) +
geom_line()  +
geom_point(
data=empl_rate_it[empl_rate_it$Year==1995 | empl_rate_it$Year==2013,],
aes(color="Red", group=interaction(Year))
) +
geom_text(
data=empl_rate_it[empl_rate_it$Year==1995 | empl_rate_it$Year==2013,],
aes(color="Red", label="Local min.", group=interaction(Year)),
hjust=-0.1, vjust=1.1, size=7
) +
scale_fill_brewer(palette="Set2") +
scale_x_discrete(limits=election_years[election_years>1976]) +
expand_limits(x=2025) +
scale_y_continuous(labels=function(x) paste0(x, "%"), breaks=seq(53, 59, 1)) +
ylab("Employment rate") +
xlab("(Election) Year") +
geom_vline(xintercept=1994, color="Grey", linetype=2, alpha=0.5) +
geom_vline(xintercept=2013, color="Grey", linetype=2, alpha=0.5) +
ggtitle("Employment rate / Political collocation (Senate)") +
theme_bw() +
theme(
axis.text.x = element_text(angle = 60, hjust = 1, size=14),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border =
)
employment_rate_line +
annotation_custom(grob = ggplotGrob(coll_cricle("Senate", 1992)), xmin = 1949, ymin = 55, ymax = 59) +
annotation_custom(grob = ggplotGrob(coll_cricle("Senate", 2008)), xmin = 1987, ymin = 52.5, ymax = 56.5) +
annotation_custom(grob = ggplotGrob(coll_cricle("Senate", 2018)), xmin = 2012, ymin = 51.5, ymax = 55.5)
dev.off()
knitr::include_graphics("./images/employment_coll.png")
png("./images/employment_coll.png",height=750,width=1400)
set2_manual_palette = c(
"Centre" = "#66C2A5",
"Centre-Left" = "#FC8D62",
"Centre-Right" = "#8DA0CB",
"Far-Left" = "#E78AC3",
"Far-Right" = "#A6D854",
"Left" = "#FFD92F",
"Right" = "#E5C494",
"Syncretic" = "#B3B3B3"
)
coll_cricle <- function(sel_house, sel_year) {
list_coll_filled %>%
filter((House == sel_house) & (Percent > 0) & (Year == sel_year)) %>%
mutate(Rank = rank(Percent)) %>%
ggplot(aes(x=Rank, y=Percent*100, fill=Collocation, alpha=0.7)) +
geom_bar(stat="identity") +
geom_text(
hjust = 1,
size = 7,
aes( y = 0, label = paste(
Collocation, " ")
)
) +
theme_minimal() +
scale_fill_manual(values =  set2_manual_palette) +
theme(
panel.grid = element_blank(),
panel.border = element_blank(),
legend.position="none",
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
plot.margin=grid::unit(c(0,0,0,0), "cm")
) +
coord_polar(theta = "y") +
ylim(0,10000)
}
employment_rate_line <- ggplot(empl_rate_it, aes(x=Year, y=Empl.Rate)) +
geom_line()  +
geom_point(
data=empl_rate_it[empl_rate_it$Year==1995 | empl_rate_it$Year==2013,],
aes(color="Red", group=interaction(Year))
) +
geom_text(
data=empl_rate_it[empl_rate_it$Year==1995 | empl_rate_it$Year==2013,],
aes(color="Red", label="Local min.", group=interaction(Year)),
hjust=-0.1, vjust=1.1, size=7
) +
scale_fill_brewer(palette="Set2") +
scale_x_discrete(limits=election_years[election_years>1976]) +
expand_limits(x=2025) +
scale_y_continuous(labels=function(x) paste0(x, "%"), breaks=seq(53, 59, 1)) +
ylab("Employment rate") +
xlab("(Election) Year") +
geom_vline(xintercept=1994, color="Grey", linetype=2, alpha=0.5) +
geom_vline(xintercept=2013, color="Grey", linetype=2, alpha=0.5) +
ggtitle("Employment rate / Political collocation (Senate)") +
theme_bw() +
theme(
axis.text.x = element_text(angle = 60, hjust = 1, size=14),
axis.text.y = element_text(size=14),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border =
)
employment_rate_line +
annotation_custom(grob = ggplotGrob(coll_cricle("Senate", 1992)), xmin = 1949, ymin = 55, ymax = 59) +
annotation_custom(grob = ggplotGrob(coll_cricle("Senate", 2008)), xmin = 1987, ymin = 52.5, ymax = 56.5) +
annotation_custom(grob = ggplotGrob(coll_cricle("Senate", 2018)), xmin = 2012, ymin = 51.5, ymax = 55.5)
dev.off()
knitr::include_graphics("./images/employment_coll.png")
png("./images/employment_coll.png",height=750,width=1400)
set2_manual_palette = c(
"Centre" = "#66C2A5",
"Centre-Left" = "#FC8D62",
"Centre-Right" = "#8DA0CB",
"Far-Left" = "#E78AC3",
"Far-Right" = "#A6D854",
"Left" = "#FFD92F",
"Right" = "#E5C494",
"Syncretic" = "#B3B3B3"
)
coll_cricle <- function(sel_house, sel_year) {
list_coll_filled %>%
filter((House == sel_house) & (Percent > 0) & (Year == sel_year)) %>%
mutate(Rank = rank(Percent)) %>%
ggplot(aes(x=Rank, y=Percent*100, fill=Collocation, alpha=0.7)) +
geom_bar(stat="identity") +
geom_text(
hjust = 1,
size = 7,
aes( y = 0, label = paste(
Collocation, " ")
)
) +
theme_minimal() +
scale_fill_manual(values =  set2_manual_palette) +
theme(
panel.grid = element_blank(),
panel.border = element_blank(),
legend.position="none",
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
plot.margin=grid::unit(c(0,0,0,0), "cm")
) +
coord_polar(theta = "y") +
ylim(0,10000)
}
employment_rate_line <- ggplot(empl_rate_it, aes(x=Year, y=Empl.Rate)) +
geom_line()  +
geom_point(
data=empl_rate_it[empl_rate_it$Year==1995 | empl_rate_it$Year==2013,],
aes(color="Red", group=interaction(Year))
) +
geom_text(
data=empl_rate_it[empl_rate_it$Year==1995 | empl_rate_it$Year==2013,],
aes(color="Red", label="Local min.", group=interaction(Year)),
hjust=-0.1, vjust=1.1, size=7
) +
scale_fill_brewer(palette="Set2") +
scale_x_discrete(limits=election_years[election_years>1976]) +
expand_limits(x=2025) +
scale_y_continuous(labels=function(x) paste0(x, "%"), breaks=seq(53, 59, 1)) +
ylab("Employment rate") +
xlab("(Election) Year") +
geom_vline(xintercept=1994, color="Grey", linetype=2, alpha=0.5) +
geom_vline(xintercept=2013, color="Grey", linetype=2, alpha=0.5) +
ggtitle("Employment rate / Political collocation (Senate)") +
theme_bw() +
theme(
axis.text.x = element_text(angle = 60, hjust = 1, size=14),
axis.text.y = element_text(size=14),
axis.title = element_text(size=14),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border =
)
employment_rate_line +
annotation_custom(grob = ggplotGrob(coll_cricle("Senate", 1992)), xmin = 1949, ymin = 55, ymax = 59) +
annotation_custom(grob = ggplotGrob(coll_cricle("Senate", 2008)), xmin = 1987, ymin = 52.5, ymax = 56.5) +
annotation_custom(grob = ggplotGrob(coll_cricle("Senate", 2018)), xmin = 2012, ymin = 51.5, ymax = 55.5)
dev.off()
knitr::include_graphics("./images/employment_coll.png")
png("./images/employment_coll.png",height=750,width=1400)
set2_manual_palette = c(
"Centre" = "#66C2A5",
"Centre-Left" = "#FC8D62",
"Centre-Right" = "#8DA0CB",
"Far-Left" = "#E78AC3",
"Far-Right" = "#A6D854",
"Left" = "#FFD92F",
"Right" = "#E5C494",
"Syncretic" = "#B3B3B3"
)
coll_cricle <- function(sel_house, sel_year) {
list_coll_filled %>%
filter((House == sel_house) & (Percent > 0) & (Year == sel_year)) %>%
mutate(Rank = rank(Percent)) %>%
ggplot(aes(x=Rank, y=Percent*100, fill=Collocation, alpha=0.7)) +
geom_bar(stat="identity") +
geom_text(
hjust = 1,
size = 7,
aes( y = 0, label = paste(
Collocation, " ")
)
) +
theme_minimal() +
scale_fill_manual(values =  set2_manual_palette) +
theme(
panel.grid = element_blank(),
panel.border = element_blank(),
legend.position="none",
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
plot.margin=grid::unit(c(0,0,0,0), "cm")
) +
coord_polar(theta = "y") +
ylim(0,10000)
}
employment_rate_line <- ggplot(empl_rate_it, aes(x=Year, y=Empl.Rate)) +
geom_line()  +
geom_point(
data=empl_rate_it[empl_rate_it$Year==1995 | empl_rate_it$Year==2013,],
aes(color="Red", group=interaction(Year))
) +
geom_text(
data=empl_rate_it[empl_rate_it$Year==1995 | empl_rate_it$Year==2013,],
aes(color="Red", label="Local min.", group=interaction(Year)),
hjust=-0.1, vjust=1.1, size=7
) +
scale_fill_brewer(palette="Set2") +
scale_x_discrete(limits=election_years[election_years>1976]) +
expand_limits(x=2025) +
scale_y_continuous(labels=function(x) paste0(x, "%"), breaks=seq(53, 59, 1)) +
ylab("Employment rate") +
xlab("(Election) Year") +
geom_vline(xintercept=1994, color="Grey", linetype=2, alpha=0.5) +
geom_vline(xintercept=2013, color="Grey", linetype=2, alpha=0.5) +
ggtitle("Employment rate / Political collocation (Senate)") +
theme_bw() +
theme(
axis.text.x = element_text(angle = 60, hjust = 1, size=14),
axis.text.y = element_text(size=14),
axis.title = element_text(size=14),
plot.title = element_text(size=14),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border =
)
employment_rate_line +
annotation_custom(grob = ggplotGrob(coll_cricle("Senate", 1992)), xmin = 1949, ymin = 55, ymax = 59) +
annotation_custom(grob = ggplotGrob(coll_cricle("Senate", 2008)), xmin = 1987, ymin = 52.5, ymax = 56.5) +
annotation_custom(grob = ggplotGrob(coll_cricle("Senate", 2018)), xmin = 2012, ymin = 51.5, ymax = 55.5)
dev.off()
knitr::include_graphics("./images/employment_coll.png")
png("./images/employment_coll.png",height=750,width=1400)
set2_manual_palette = c(
"Centre" = "#66C2A5",
"Centre-Left" = "#FC8D62",
"Centre-Right" = "#8DA0CB",
"Far-Left" = "#E78AC3",
"Far-Right" = "#A6D854",
"Left" = "#FFD92F",
"Right" = "#E5C494",
"Syncretic" = "#B3B3B3"
)
coll_cricle <- function(sel_house, sel_year) {
list_coll_filled %>%
filter((House == sel_house) & (Percent > 0) & (Year == sel_year)) %>%
mutate(Rank = rank(Percent)) %>%
ggplot(aes(x=Rank, y=Percent*100, fill=Collocation, alpha=0.7)) +
geom_bar(stat="identity") +
geom_text(
hjust = 1,
size = 7,
aes( y = 0, label = paste(
Collocation, " ")
)
) +
theme_minimal() +
scale_fill_manual(values =  set2_manual_palette) +
theme(
panel.grid = element_blank(),
panel.border = element_blank(),
legend.position="none",
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
plot.margin=grid::unit(c(0,0,0,0), "cm")
) +
coord_polar(theta = "y") +
ylim(0,10000)
}
employment_rate_line <- ggplot(empl_rate_it, aes(x=Year, y=Empl.Rate)) +
geom_line()  +
geom_point(
data=empl_rate_it[empl_rate_it$Year==1995 | empl_rate_it$Year==2013,],
aes(color="Red", group=interaction(Year))
) +
geom_text(
data=empl_rate_it[empl_rate_it$Year==1995 | empl_rate_it$Year==2013,],
aes(color="Red", label="Local min.", group=interaction(Year)),
hjust=-0.1, vjust=1.1, size=7
) +
scale_fill_brewer(palette="Set2") +
scale_x_discrete(limits=election_years[election_years>1976]) +
expand_limits(x=2025) +
scale_y_continuous(labels=function(x) paste0(x, "%"), breaks=seq(53, 59, 1)) +
ylab("Employment rate") +
xlab("(Election) Year") +
geom_vline(xintercept=1994, color="Grey", linetype=2, alpha=0.5) +
geom_vline(xintercept=2013, color="Grey", linetype=2, alpha=0.5) +
ggtitle("Employment rate / Political collocation (Senate)") +
theme_bw() +
theme(
axis.text.x = element_text(angle = 60, hjust = 1, size=14),
axis.text.y = element_text(size=14),
axis.title = element_text(size=14),
plot.title = element_text(size=14),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border =
)
employment_rate_line +
annotation_custom(grob = ggplotGrob(coll_cricle("Senate", 1992)), xmin = 1949, ymin = 55, ymax = 59) +
annotation_custom(grob = ggplotGrob(coll_cricle("Senate", 2008)), xmin = 1987, ymin = 52.5, ymax = 56.5) +
annotation_custom(grob = ggplotGrob(coll_cricle("Senate", 2018)), xmin = 2012, ymin = 51.5, ymax = 55.5)
dev.off()
knitr::include_graphics("./images/employment_coll.png")
