paste(
'Voter turnout: ',
ballot_React()$Voter.turnout,
'<br/>',
'Parties: ',
aggregate_list_React()$Party
) %>%
lapply(htmltools::HTML)
)
})
fillCol <- reactive({
#Fill column
if(input$fill_sel == 'Voter turnout') {
italy_React()$Voter.turnout
}
else if(input$fill_sel == 'Top party collocation') {
italy_React()$Collocation
}
})
map_data <- reactive({
if(input$shape_sel == 'Regions') {
m <- leaflet(italy_React()) %>%
addPolygons(
stroke = TRUE,
color = 'Grey',
weight = 1.5,
label = reg_labels(),
highlightOptions = highlightOptions(color = "grey", weight = 3, bringToFront = TRUE),
fillColor = ~pal()(fillCol()))
}
else if(input$shape_sel == 'Voters') {
m <- leaflet(italy_React()) %>%
addCircleMarkers(
stroke = TRUE,
color = 'Grey',
weight = 1.5,
label = reg_labels(),
italy_React()$centroid_lat,
italy_React()$centroid_long,
radius = sqrt(italy_React()$Voters/10000),
fillColor = ~pal()(fillCol()))
}
else{
m <- leaflet(italy_React()) %>%
addPolygons(
stroke = TRUE,
color = 'Grey',
weight = 1.5) %>%
addCircleMarkers(
stroke = TRUE,
color = 'Grey',
weight = 1.5,
label = reg_labels(),
italy_React()$centroid_lat,
italy_React()$centroid_long,
radius = sqrt(italy_React()$Voters/10000),
fillColor = ~pal()(fillCol()))
}
})
output$map <- renderLeaflet({
map_data() %>%
addLegend(
pal = pal(),
values = fillCol(),
opacity = 0.7,
position = 'bottomright')
})
}
shinyApp(ui, server)
list_it_top <- list_it %>%
group_by(Year, House) %>%
filter(quantile(Votes, 0.7)<Votes)
list_reg_top <- list_reg %>%
group_by(Region, Year, House) %>%
filter(quantile(Votes, 0.7)<Votes)
list_reg_top_before <- list_reg_top
# To this top parties, we would also like to associate their poilitical collocation
# (Far-Left,Left,Centre-Left,Centre,Centre-Right,Syncretic,Right,Far-Right)
party_collocation <- read.csv(
"./source/elections/party-collocation.csv",
header = TRUE,
sep = ";"
)
list_it_top <- full_join(
list_it_top,
party_collocation
)
list_reg_top <- full_join(
list_reg_top,
party_collocation
)
list_it_top
list_reg_top
library(compare)
install.packages("Compare")
install.packages("compare")
list_it_top <- list_it %>%
group_by(Year, House) %>%
filter(quantile(Votes, 0.7)<Votes)
list_reg_top <- list_reg %>%
group_by(Region, Year, House) %>%
filter(quantile(Votes, 0.7)<Votes)
list_reg_top_before <- list_reg_top
# To this top parties, we would also like to associate their poilitical collocation
# (Far-Left,Left,Centre-Left,Centre,Centre-Right,Syncretic,Right,Far-Right)
party_collocation <- read.csv(
"./source/elections/party-collocation.csv",
header = TRUE,
sep = ";"
)
list_it_top <- full_join(
list_it_top,
party_collocation
)
list_reg_top <- full_join(
list_reg_top,
party_collocation
)
list_it_top
list_reg_top
library(compare)
compare(list_reg_top, list_reg_top_before, allowAll=TRUE)
list_it_top <- list_it %>%
group_by(Year, House) %>%
filter(quantile(Votes, 0.7)<Votes)
list_reg_top <- list_reg %>%
group_by(Region, Year, House) %>%
filter(quantile(Votes, 0.7)<Votes)
list_reg_top_before <- list_reg_top
# To this top parties, we would also like to associate their poilitical collocation
# (Far-Left,Left,Centre-Left,Centre,Centre-Right,Syncretic,Right,Far-Right)
party_collocation <- read.csv(
"./source/elections/party-collocation.csv",
header = TRUE,
sep = ";"
)
list_it_top <- full_join(
list_it_top,
party_collocation
)
list_reg_top <- full_join(
list_reg_top,
party_collocation
)
list_it_top
list_reg_top
library(compare)
comparison <- compare(list_reg_top, list_reg_top_before, allowAll=TRUE)
comparison
list_it_top <- list_it %>%
group_by(Year, House) %>%
filter(quantile(Votes, 0.7)<Votes)
list_reg_top <- list_reg %>%
group_by(Region, Year, House) %>%
filter(quantile(Votes, 0.7)<Votes)
list_reg_top_before <- list_reg_top
# To this top parties, we would also like to associate their poilitical collocation
# (Far-Left,Left,Centre-Left,Centre,Centre-Right,Syncretic,Right,Far-Right)
party_collocation <- read.csv(
"./source/elections/party-collocation.csv",
header = TRUE,
sep = ";"
)
list_it_top <- full_join(
list_it_top,
party_collocation
)
list_reg_top <- full_join(
list_reg_top,
party_collocation
)
list_it_top
list_reg_top
library(compare)
comparison <- compare(list_reg_top_before, list_reg_top, allowAll=TRUE)
comparison
list_it_top <- list_it %>%
group_by(Year, House) %>%
filter(quantile(Votes, 0.7)<Votes)
list_reg_top <- list_reg %>%
group_by(Region, Year, House) %>%
filter(quantile(Votes, 0.7)<Votes)
list_reg_top_before <- list_reg_top
# To this top parties, we would also like to associate their poilitical collocation
# (Far-Left,Left,Centre-Left,Centre,Centre-Right,Syncretic,Right,Far-Right)
party_collocation <- read.csv(
"./source/elections/party-collocation.csv",
header = TRUE,
sep = ";"
)
list_it_top <- full_join(
list_it_top,
party_collocation
)
list_reg_top <- full_join(
list_reg_top,
party_collocation
)
library(compare)
comparison <- compare(list_reg_top_before, list_reg_top, allowAll=TRUE)
comparison
list_it_top <- list_it %>%
group_by(Year, House) %>%
filter(quantile(Votes, 0.7)<Votes)
list_reg_top <- list_reg %>%
group_by(Region, Year, House) %>%
filter(quantile(Votes, 0.7)<Votes)
list_reg_top_before <- list_reg_top
# To this top parties, we would also like to associate their poilitical collocation
# (Far-Left,Left,Centre-Left,Centre,Centre-Right,Syncretic,Right,Far-Right)
party_collocation <- read.csv(
"./source/elections/party-collocation.csv",
header = TRUE,
sep = ";"
)
list_it_top <- full_join(
list_it_top,
party_collocation
)
list_reg_top <- full_join(
list_reg_top,
party_collocation
)
list_it_top
list_reg_top
library(compare)
comparison <- compare(list_reg_top_before, list_reg_top, allowAll=TRUE)
comparison$tM
list_it_top <- list_it %>%
group_by(Year, House) %>%
filter(quantile(Votes, 0.7)<Votes)
list_reg_top <- list_reg %>%
group_by(Region, Year, House) %>%
filter(quantile(Votes, 0.7)<Votes)
list_reg_top_before <- list_reg_top
# To this top parties, we would also like to associate their poilitical collocation
# (Far-Left,Left,Centre-Left,Centre,Centre-Right,Syncretic,Right,Far-Right)
party_collocation <- read.csv(
"./source/elections/party-collocation.csv",
header = TRUE,
sep = ";"
)
list_it_top <- full_join(
list_it_top,
party_collocation
)
list_reg_top <- full_join(
list_reg_top,
party_collocation
)
list_it_top
list_reg_top
library(compare)
comparison <- compare(list_reg_top_before, list_reg_top, allowAll=TRUE)
comparison$tM
install.packages(compareDF)
install.packages("compareDF")
list_it_top <- list_it %>%
group_by(Year, House) %>%
filter(quantile(Votes, 0.7)<Votes)
list_reg_top <- list_reg %>%
group_by(Region, Year, House) %>%
filter(quantile(Votes, 0.7)<Votes)
list_reg_top_before <- list_reg_top
# To this top parties, we would also like to associate their poilitical collocation
# (Far-Left,Left,Centre-Left,Centre,Centre-Right,Syncretic,Right,Far-Right)
party_collocation <- read.csv(
"./source/elections/party-collocation.csv",
header = TRUE,
sep = ";"
)
list_it_top <- full_join(
list_it_top,
party_collocation
)
list_reg_top <- full_join(
list_reg_top,
party_collocation
)
list_it_top
list_reg_top
library(compareDF)
comparison <- compare_df(list_reg_top_before, list_reg_top)
list_it_top <- list_it %>%
group_by(Year, House) %>%
filter(quantile(Votes, 0.7)<Votes)
list_reg_top <- list_reg %>%
group_by(Region, Year, House) %>%
filter(quantile(Votes, 0.7)<Votes)
liste_reg_top
list_reg_top_before <- list_reg_top
# To this top parties, we would also like to associate their poilitical collocation
# (Far-Left,Left,Centre-Left,Centre,Centre-Right,Syncretic,Right,Far-Right)
party_collocation <- read.csv(
"./source/elections/party-collocation.csv",
header = TRUE,
sep = ";"
)
list_it_top <- full_join(
list_it_top,
party_collocation
)
list_reg_top <- full_join(
list_reg_top,
party_collocation
)
list_it_top
list_reg_top
library(compareDF)
comparison <- compare_df(list_reg_top_before, list_reg_top)
list_it_top <- list_it %>%
group_by(Year, House) %>%
filter(quantile(Votes, 0.7)<Votes)
list_reg_top <- list_reg %>%
group_by(Region, Year, House) %>%
filter(quantile(Votes, 0.7)<Votes)
list_reg_top_before <- list_reg_top
# To this top parties, we would also like to associate their poilitical collocation
# (Far-Left,Left,Centre-Left,Centre,Centre-Right,Syncretic,Right,Far-Right)
party_collocation <- read.csv(
"./source/elections/party-collocation.csv",
header = TRUE,
sep = ";"
)
list_it_top <- full_join(
list_it_top,
party_collocation
)
list_reg_top <- full_join(
list_reg_top,
party_collocation
)
list_it_top
list_reg_top
library(compareDF)
comparison <- compare_df(list_reg_top_before, list_reg_top, c("Collocation"))
list_it_top <- list_it %>%
group_by(Year, House) %>%
filter(quantile(Votes, 0.7)<Votes)
list_reg_top <- list_reg %>%
group_by(Region, Year, House) %>%
filter(quantile(Votes, 0.7)<Votes)
list_reg_top_before <- list_reg_top
# To this top parties, we would also like to associate their poilitical collocation
# (Far-Left,Left,Centre-Left,Centre,Centre-Right,Syncretic,Right,Far-Right)
party_collocation <- read.csv(
"./source/elections/party-collocation.csv",
header = TRUE,
sep = ";"
)
list_it_top <- full_join(
list_it_top,
party_collocation
)
list_reg_top <- full_join(
list_reg_top,
party_collocation
)
list_it_top
list_reg_top
library(compareDF)
comparison <- compare_df(list_reg_top_before, subset(list_reg_top, select = -Collocation))
comparison
list_it_top <- list_it %>%
group_by(Year, House) %>%
filter(quantile(Votes, 0.7)<Votes)
list_reg_top <- list_reg %>%
group_by(Region, Year, House) %>%
filter(quantile(Votes, 0.7)<Votes)
list_reg_top_before <- list_reg_top
# To this top parties, we would also like to associate their poilitical collocation
# (Far-Left,Left,Centre-Left,Centre,Centre-Right,Syncretic,Right,Far-Right)
party_collocation <- read.csv(
"./source/elections/party-collocation.csv",
header = TRUE,
sep = ";"
)
list_it_top <- full_join(
list_it_top,
party_collocation
)
list_reg_top <- full_join(
list_reg_top,
party_collocation
)
library(compareDF)
comparison <- compare_df(list_reg_top_before, subset(list_reg_top, select = -Collocation))
comparison
list_it_top <- list_it %>%
group_by(Year, House) %>%
filter(quantile(Votes, 0.7)<Votes)
list_reg_top <- list_reg %>%
group_by(Region, Year, House) %>%
filter(quantile(Votes, 0.7)<Votes)
list_reg_top_before <- list_reg_top
# To this top parties, we would also like to associate their poilitical collocation
# (Far-Left,Left,Centre-Left,Centre,Centre-Right,Syncretic,Right,Far-Right)
party_collocation <- read.csv(
"./source/elections/party-collocation.csv",
header = TRUE,
sep = ";"
)
list_it_top <- full_join(
list_it_top,
party_collocation
)
list_reg_top <- full_join(
list_reg_top,
party_collocation
)
library(compareDF)
comparison <- compare_df(list_reg_top_before, subset(list_reg_top, select = -Collocation))
comparison
liste_reg_top_before
list_it_top <- list_it %>%
group_by(Year, House) %>%
filter(quantile(Votes, 0.7)<Votes)
list_reg_top <- list_reg %>%
group_by(Region, Year, House) %>%
filter(quantile(Votes, 0.7)<Votes)
list_reg_top_before <- list_reg_top
# To this top parties, we would also like to associate their poilitical collocation
# (Far-Left,Left,Centre-Left,Centre,Centre-Right,Syncretic,Right,Far-Right)
party_collocation <- read.csv(
"./source/elections/party-collocation.csv",
header = TRUE,
sep = ";"
)
list_it_top <- full_join(
list_it_top,
party_collocation
)
list_reg_top <- full_join(
list_reg_top,
party_collocation
)
liste_reg_top_before
list_it_top <- list_it %>%
group_by(Year, House) %>%
filter(quantile(Votes, 0.7)<Votes)
list_reg_top <- list_reg %>%
group_by(Region, Year, House) %>%
filter(quantile(Votes, 0.7)<Votes)
list_reg_top
# To this top parties, we would also like to associate their poilitical collocation
# (Far-Left,Left,Centre-Left,Centre,Centre-Right,Syncretic,Right,Far-Right)
party_collocation <- read.csv(
"./source/elections/party-collocation.csv",
header = TRUE,
sep = ";"
)
list_it_top <- full_join(
list_it_top,
party_collocation
)
list_reg_top <- full_join(
list_reg_top,
party_collocation
)
list_it_top <- list_it %>%
group_by(Year, House) %>%
filter(quantile(Votes, 0.7)<Votes)
list_reg_top <- list_reg %>%
group_by(Region, Year, House) %>%
filter(quantile(Votes, 0.7)<Votes)
list_reg_top
# To this top parties, we would also like to associate their poilitical collocation
# (Far-Left,Left,Centre-Left,Centre,Centre-Right,Syncretic,Right,Far-Right)
party_collocation <- read.csv(
"./source/elections/party-collocation.csv",
header = TRUE,
sep = ";"
)
list_it_top <- full_join(
list_it_top,
party_collocation
)
list_reg_top <- full_join(
list_reg_top,
party_collocation
)
liste_reg_top
list_it_top <- list_it %>%
group_by(Year, House) %>%
filter(quantile(Votes, 0.7)<Votes)
list_reg_top <- list_reg %>%
group_by(Region, Year, House) %>%
filter(quantile(Votes, 0.7)<Votes)
list_reg_it
list_it_top <- list_it %>%
group_by(Year, House) %>%
filter(quantile(Votes, 0.7)<Votes)
list_reg_top <- list_reg %>%
group_by(Region, Year, House) %>%
filter(quantile(Votes, 0.7)<Votes)
list_it_top
# To this top parties, we would also like to associate their poilitical collocation
# (Far-Left,Left,Centre-Left,Centre,Centre-Right,Syncretic,Right,Far-Right)
party_collocation <- read.csv(
"./source/elections/party-collocation.csv",
header = TRUE,
sep = ";"
)
list_it_top <- full_join(
list_it_top,
party_collocation
)
list_reg_top <- full_join(
list_reg_top,
party_collocation
)
list_it_top
